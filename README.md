# Программное обеспечение для распознавания дорожных знаков

## Процесс обучения каскада Хаара

Обучение происходит в 2 этапа. Сначала все положительные изображения приводятся к общему формату. У OpenCV есть готовая программа для этого – opencv_createsamples.exe ([скачайте старую версию OpenCV](https://github.com/opencv/opencv/releases/download/3.4.11/opencv-3.4.11-vc14_vc15.exe)).
Для создания пачки приведённых положительных изображений opencv_createsamples запускается через консоль:

```opencv_createsamples.exe -info [Вашпуть]\Good.dat -vecsamples.vec -w 20 -h 20```

где:
*	-info [Вашпуть]\Good.dat - файл описания «положительных» изображений.
*	-vecsamples.vec – файл, в который будет сохранена приведённая к общему формату база «положительных» изображений.
*	-w 20 -h 20 – размер шаблона.
  
После чего создаем итоговый каскад. Для подсчёта итогового каскада используется программа «opencv_traincascade.exe». 
Запуск программы через консоль:

```opencv_traincascade.exe -data haarcascade -vecsamples.vec -bg[Вашпуть]\Bad.dat -numStages22 -minhitrate 0.999 -maxFalseAlarmRate 0.4 -numPos 1000 -numNeg 1000 -w 20 -h 20 -mode ALL -precalcValBufSize 1024 -precalcIdxBufSize 1024```

где:
*	-datahaarcascade – адрес папки, куда сохраняются полученные результаты;
*	-vecsamples.vec – адрес посчитанного в прошлом пункте файла с «положительными» примерами;
*	-bg [Вашпуть]\Bad.dat – адрес файла-описания отрицательных примеров;
*	-numStages 22 – количество уровней каскада, которые программа бу-дет обучать. Чем больше уровней, тем точнее, но тем дольше. Доста-точное количество в диапазоне от 16 до 25;
*	-minhitrate 0.999 – коэффициент, определяющий качество обучения;
*	-maxFalseAlarmRate 0.4 – уровень ложной тревоги;
*	-numPos 1000 – количество позитивных примеров;
*	-numNeg 1000 – количество отрицательных примеров;
*	-modeALL – использовать или нет полный комплект Хаар-признаков;
*	-precalcValBufSize4096 -precalcIdxBufSize4096 – выделяемая под процесс память.

## Результат работы

В результате у нас получается xml файл, описывающий каскад Хаара.

 ![image](https://github.com/user-attachments/assets/486838de-0214-4e38-8466-1ba879914100)

Обученный каскад Хаара умеет распознавать дорожные знаки, например «налево»

![image](https://github.com/user-attachments/assets/08d1e3cc-e477-491e-a8b5-f6e620b5cde4)


## Стек технологий
* C++ 11 и старше
* openCV не старше 3.4 
